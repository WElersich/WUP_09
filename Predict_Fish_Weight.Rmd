---
title: "Weight of Fish"
author: "Wilhelmus Elersich"
date: "`r Sys.Date()`"  
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5

 
    
---


```{r include=FALSE,echo=FALSE}
require(tigerstats)
require(tidyverse)
Fish <- read.csv("Fish.csv")
```

# Predicting Fish Weight


## Perch

```{r}
Perch <- filter(Fish, Species == "Perch") %>%
  select(-Species)
```

### Best Models



### Best Two regressor model

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Perch,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="topright",main="Adjusted R^2")
```

The best model is the Two Regressor model that predicts Weight by Height and Width, which gives the highest adjusted R-sqaured value.

```{R}
PerchModel <- lm(Weight~Height + Width, data = Perch)
summary.lm(PerchModel)
```
The adjusted r-squared value is 0.94. The residual standard error is 85.17.

```{R}
PerchModel1 <- lm(Weight~Height + Width + Length2, data = Perch)
summary.lm(PerchModel1)
```

The adjusted R-sqaured value is 0.939. The Residual standard error is 85.87.

These two models, PerchModel and PerchModel1, confirm, through the residual standard errors and Adjusted R-squared values confirm that the above two regressor model is superior to the three regressor model.

## Bream

```{r}
Bream <- filter(Fish, Species == "Bream") %>%
  select(-Species)
```

### Best Models



### Best Two regressor model

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Bream,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomright",main="Adjusted R^2")
```

The three regressor model, which predicts Weight by Height, Width, and Length1 is the best model, because it has the highest adjusted r-squared value. The best two regressor model predicts based on Length2 and Height.

```{R}
BreamModel <- lm(Weight~Height + Width + Length1, data = Bream)
summary.lm(BreamModel)
```
The adjusted r-squared value is 0.9372. The residual standard error is 52.43.

```{R}
BreamModel1 <- lm(Weight~Height + Length2, data = Bream)
summary.lm(BreamModel1)
```
The adjusted R-squared value is 0.9356. The Residual standard error is 53.1.

## Roach

```{r}
Roach <- filter(Fish, Species == "Roach") %>%
  select(-Species)
```

### Best Models



### Best Two regressor model

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Roach,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="topright",main="Adjusted R^2")
```

By looking at the adjusted R-squared value, we can conclude that the best model is the two regression model, which predicts based off Length3 and Width.

```{R}
RoachModel <- lm(Weight~Length3 + Width, data = Roach)
summary.lm(RoachModel)
```

The adjusted R-squared value is 0.0.8482. The Residual standard error is 34.61.

## Final Summary Statements

```{r}
favstats(Weight~Species, data = Fish)
```

Bream have a mean weight of 617.8257, which is nearly twice as large as the mean weight of Perch, at 382.23929. Perch are more than twice as heavy on average as Roach, which have a mean weight of 152.03000. The standard deviation for Bream is 209.205709, the standard deviation for Perch is nearly twice that at 347.617717, and the standard deviation for Roach is less than half that of Bream, at 88.828916. 

The ratio of the mean weight of a bream to the mean weight of a perch is 1.616332, the ratio of the mean weight of a perch to a roach is 2.513905, and the ratio of the mean weight of a roach to a bream 0.246105

For the best Perch model, the adjusted r-squared value is 0.94. The residual standard error is 85.17. For the best 2 regressor Bream model, The adjusted R-squared value is 0.9356. The Residual standard error is 53.1.

```{r}
basicPerch <- ggplot(Perch,aes(y=Weight,x=Length3)) + geom_point() + geom_lm()
basicPerch
```
```{r}
basicBream <- ggplot(Bream,aes(y=Weight,x=Length1)) + geom_point() + geom_lm()
basicBream
```
```{r}
basicRoach <- ggplot(Roach,aes(y=Weight,x=Length1)) + geom_point()
basicRoach
```
